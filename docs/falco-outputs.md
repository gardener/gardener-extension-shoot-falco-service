# Falco Outputs

## Do not forward Falco events (option `none`)

With this option events are not forwarded but logged to Falco pod logs. Users may
deploy custom tools to scrape pod logs to store events.

Falcosidekick will not be deployed with this option.

## Store events in the cluster logging stack (option `cluster`)

With this configuration Falco events are forwarded to Falcosidekick. The 
[Falcosidekick Loki output](https://github.com/falcosecurity/falcosidekick/blob/master/docs/outputs/loki.md)
is configured to forward events to the cluster vali database.

Events can be queried in the vali section of the cluster Plutono UI.
The basic query for retrieving events is

```
{rule=~".+", tags=~".+", source=~".+"}
```

More detailed on possible queries can be found in the 
[LogQL documentation](https://grafana.com/docs/loki/latest/query/).

## Store events centrally (option `central`)

The central storage is optional and may be provided by the Gardener landscape
installation.

Events that are generated by Falco are forwarded to Falcosidekick that is 
deployed alongside Falco. The Falcosidekick 
[webhook output](https://github.com/falcosecurity/falcosidekick/blob/master/docs/outputs/webhook.md)
is configured to send events to a central location configured by the Gardener
installation. Events are forwarded with a cluster JWT token issued by the Falco
extension.

Centrally, the [Falco event ingestor](https://github.com/gardener/falco-event-ingestor) 
receives events, validates their integriy and validity, and stores them in a 
database. The event ingestor component implements configurable rate limiting 
per cluster to avoid overwhelming it with millions of false positive events.

The [Falco event provider](https://github.com/gardener/falco-event-provider) 
component provides a REST API to the database. Cluster users need to present
a valid token (Viewer access for the project namespace) to retrieve Falco events
for a cluster in their project.
